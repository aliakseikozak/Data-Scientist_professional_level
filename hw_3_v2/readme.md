# Football Object Detection with YOLOv8

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Ñ—É—Ç–±–æ–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –∏ –≤–∏–¥–µ–æ: –∏–≥—Ä–æ–∫–æ–≤, —Å—É–¥–µ–π –∏ –º—è—á–∞, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π **YOLOv8**.

–î–∞—Ç–∞—Å–µ—Ç—ã:
- [Google Drive Football Dataset](https://drive.google.com/drive/folders/17w9yhEDZS7gLdZGjiwPQytLz3-iTUpKm) –¥–ª—è YOLOv8

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
hw_3_v2/
‚îú‚îÄ‚îÄ dataset/                       
‚îÇ   ‚îú‚îÄ‚îÄ data.yaml
‚îú‚îÄ‚îÄ results/                       # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ football_analytics_out.mp4 # –†–µ–∑—É–ª—å—Ç–∞—Ç  –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ weights/                       # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ best.pt                    # –û–±—É—á–µ–Ω–∞—è –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ test_videos/                   # –ü–∞–ø–∫–∞ —Å –≤–∏–¥–µ–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ fragment_1080p50_av1.mp4   # –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ–µ –≤–∏–¥–µ–æ
‚îú‚îÄ‚îÄ test_football.py               # –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –Ω–∞ –≤–∏–¥–µ–æ
‚îî‚îÄ‚îÄ README.md
```


## ‚ö° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### a) PyTorch (CPU)
```bash pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu ```

#### b) OpenCV –∏ matplotlib
```bash pip install opencv-python matplotlib```

#### c) Ultralytics (YOLOv8)
```bash pip install ultralytics```


---

## ‚ö° –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ YOLOv8

–ú–æ–¥–µ–ª—å –±—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Ultralytics YOLOv8** –Ω–∞ —Ñ—É—Ç–±–æ–ª—å–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏ –¥–ª—è –∫–ª–∞—Å—Å–æ–≤: `Player`, `GoalKeeper`, `Ball`, `Main Referee`, `Side Referee`, `Staff Member`. –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –≤ **Google Colab** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GPU Tesla T4.

**–î–∞—Ç–∞—Å–µ—Ç:** [Google Drive](https://drive.google.com/drive/folders/17w9yhEDZS7gLdZGjiwPQytLz3-iTUpKm)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: `YOLOv8m` (—Å—Ä–µ–¥–Ω—è—è –º–æ–¥–µ–ª—å)
- –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞: `yolov8m.pt`
- –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 720 √ó 720
- –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞: 16
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö: 10
- –ù–∞—á–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è: 0.03
- –ü–∞—Ä–∞–º–µ—Ç—Ä `resume=True`
- –ü—Ä–æ–µ–∫—Ç: `/content/drive/MyDrive/FootballObjectDetection/yolov8`

**–ù–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö:**
- Train set: 10212 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Validation set: 1276 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Test set: 1276 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

> ‚ÑπÔ∏è **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í –≤—ã–≤–æ–¥–µ Ultralytics YOLOv8 –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (1276) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç **–≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º—É –Ω–∞–±–æ—Ä—É**, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏ Precision, Recall –∏ mAP –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏.

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è (–ø–æ validation set):**

| –ö–ª–∞—Å—Å            | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | –û–±—ä–µ–∫—Ç–æ–≤ | Precision | Recall | mAP@0.5 | mAP@0.5:0.95 |
|-----------------|------------|----------|----------|--------|---------|---------------|
| –í—Å–µ –∫–ª–∞—Å—Å—ã       | 1276       | 18895    | 0.846    | 0.829  | 0.849   | 0.625         |
| Player           | 1276       | 15231    | 0.947    | 0.957  | 0.980   | 0.779         |
| GoalKeeper       | 1276       | 845      | 0.851    | 0.907  | 0.906   | 0.677         |
| Ball             | 1276       | 994      | 0.772    | 0.453  | 0.526   | 0.224         |
| Main Referee     | 1276       | 886      | 0.942    | 0.960  | 0.982   | 0.840         |
| Side Referee     | 1276       | 693      | 0.843    | 0.889  | 0.905   | 0.601         |
| Staff Member     | 1276       | 246      | 0.722    | 0.809  | 0.799   | 0.626         |

**–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
- Preprocess: 0.2 ms
- Inference: 7.7 ms
- Loss: 0.0 ms
- Postprocess: 1.7 ms

**–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–∞–∑–º–µ—Ä—ã –≤–µ—Å–æ–≤:**
- 10 —ç–ø–æ—Ö –∑–∞–≤–µ—Ä—à–µ–Ω—ã –∑–∞ **1.918 —á–∞—Å–∞**
- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —É–¥–∞–ª—ë–Ω –∏–∑ —Ñ–∞–π–ª–æ–≤ –≤–µ—Å–æ–≤:
  - `best.pt`: 52.0 MB


---

## ‚ö° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –≤–∏–¥–µ–æ

```python test_football.py```

üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–º–µ–Ω—å—à–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∫–∞–¥—Ä–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ CPU.

---

## üìä –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ

–ù–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ –≤–∏–¥–µ–æ –ø–æ—Å–ª–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

1. **–°—Ç–∞—Ç—É—Å –∏–≥—Ä—ã**
   - üü¢ Safe Play ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–≥—Ä–∞
   - üü° Dangerous Moment ‚Äî –æ–ø–∞—Å–Ω—ã–π –º–æ–º–µ–Ω—Ç
   - üî¥ Goal Threat ‚Äî —É–≥—Ä–æ–∑–∞ –≥–æ–ª–∞

2. **–í–ª–∞–¥–µ–Ω–∏–µ –º—è—á–æ–º**
   - –ù–∏–∂–Ω—è—è –ø–æ–ª–æ—Å–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç –≤–ª–∞–¥–µ–Ω–∏—è –º—è—á–æ–º –¥–ª—è –ª–µ–≤–æ–π –∏ –ø—Ä–∞–≤–æ–π –∫–æ–º–∞–Ω–¥—ã
   - –ß–∏—Å–ª–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–ª–∞–¥–µ–Ω–∏—è: Possession L:XX% R:XX%

3. **–î–∏—Å—Ç–∞–Ω—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤**
   - –í–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ—Å–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–π–¥–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥–∞
   - –ß–∏—Å–ª–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏: Distance L:XX R:XX

4. **–ò–≥—Ä–æ–∫–∏**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ –ø–æ–ª–µ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º: Players L:XX R:XX
   - –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä–æ–∫–æ–≤: Avg player speed L:XX R:XX

5. **–ú—è—á**
   - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º—è—á–∞: Ball pos: (x,y)
   - –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –º—è—á–∞: Ball speed: XX
   - –ü—Ä–æ–π–¥–µ–Ω–Ω–∞—è –º—è—á–æ–º –¥–∏—Å—Ç–∞–Ω—Ü–∏—è: Ball distance: XX

6. **–ú–∏–Ω–∏-–∫–∞—Ä—Ç–∞ –ø–æ–ª—è**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∏ –º—è—á–∞ –Ω–∞ –º–∏–Ω–∏-–∫–∞—Ä—Ç–µ

---

## üìä –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ–º—ã–µ –æ–±—ä–µ–∫—Ç—ã

- `Football` ‚Äî –º—è—á
- `Player` ‚Äî –∏–≥—Ä–æ–∫
- `GoalKeeper` ‚Äî –≤—Ä–∞—Ç–∞—Ä—å
- `Main Referee` ‚Äî –≥–ª–∞–≤–Ω—ã–π —Å—É–¥—å—è
- `Side Referee` ‚Äî –±–æ–∫–æ–≤–æ–π —Å—É–¥—å—è
- `Staff Member` ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª

---

## ‚öôÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–æ–¥–µ–ª–∏ –æ–±—É—á–µ–Ω—ã –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö.
- –ù–∞ CPU –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ–π (–ø—Ä–∏–º–µ—Ä–Ω–æ 2‚Äì5 FPS –¥–ª—è 1080p).
- YOLO –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥–æ–Ω—è–µ—Ç —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ (auto-resize).

---

## üîó –°—Å—ã–ª–∫–∏

- [YOLOv5 GitHub](https://github.com/ultralytics/yolov5)
- [Ultralytics YOLO](https://docs.ultralytics.com/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenCV](https://opencv.org/)