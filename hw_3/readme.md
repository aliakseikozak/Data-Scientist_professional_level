# Football Object Detection with YOLOv5

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Ñ—É—Ç–±–æ–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –∏ –≤–∏–¥–µ–æ: –∏–≥—Ä–æ–∫–æ–≤, —Å—É–¥–µ–π –∏ –º—è—á–∞, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ **YOLOv5**.
–î–∞—Ç–∞—Å–µ—Ç —Å–∫–∞—á–∞–Ω —Å https://universe.roboflow.com/football-detection/football-dectection

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
hw_3/
‚îú‚îÄ‚îÄ dataset/               # –ü–∞–ø–∫–∏ —Å –æ–±—É—á–∞—é—â–∏–º–∏, –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ —Ç–∞–∫ –∂–µ —Ä–∞–∑–º–µ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ train/labels
‚îÇ   ‚îú‚îÄ‚îÄ train/images
‚îÇ   ‚îú‚îÄ‚îÄ valid/labels
‚îÇ   ‚îú‚îÄ‚îÄ valid/images
‚îÇ   ‚îú‚îÄ‚îÄ test/labels
‚îÇ   ‚îî‚îÄ‚îÄ test/images
‚îú‚îÄ‚îÄ results/               # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ football_model/
‚îÇ       ‚îú‚îÄ‚îÄ results.csv    # –º–µ—Ç—Ä–∏–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ weights/       # best.pt –∏ last.pt
‚îÇ       ‚îî‚îÄ‚îÄ test_output/   # –ü—Ä–æ–≥–æ–Ω–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –≤–∏–¥–µ–æ
‚îú‚îÄ‚îÄ test_images/           # –ø–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ 
‚îú‚îÄ‚îÄ test_model.py          # –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –∏ –≤–∏–¥–µ–æ
‚îú‚îÄ‚îÄ training_football.py   # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md
```

---

## ‚ö° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### a) PyTorch (CPU)
```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu```


#### b) OpenCV –∏ matplotlib
```bash
pip install opencv-python matplotlib
```

#### c) Ultralytics (YOLOv5 —á–µ—Ä–µ–∑ PyTorch Hub)

```bash
pip install ultralytics
```

d) –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è YOLOv5 –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
git clone https://github.com/ultralytics/yolov5
cd yolov5
pip install -r requirements.txt
```

---

### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```python
from training_football import train_football_model

train_football_model("dataset/data.yaml")
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
	img=416 ‚Äî —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
	batch=4 ‚Äî —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
	epochs=50 ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
	freeze=10 ‚Äî –∑–∞–º–æ—Ä–æ–∑–∫–∞ –ø–µ—Ä–≤—ã—Ö 10 —Å–ª–æ—ë–≤
	patience=15 ‚Äî —Ä–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —É–ª—É—á—à–µ–Ω–∏–π
	weights=yolov5s.pt ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞
	
	
üìä –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è	
	| –≠–ø–æ—Ö–∞ | P     | R     | mAP50 | mAP50-95 |
	| ----- | ----- | ----- | ----- | -------- |
	| 0     | 0.853 | 0.22  | 0.207 | 0.0703   |
	| 1     | 0.93  | 0.264 | 0.317 | 0.103    |
	| 2     | 0.705 | 0.364 | 0.344 | 0.126    |
	| 3     | 0.77  | 0.368 | 0.39  | 0.145    |
	| 4     | 0.758 | 0.38  | 0.429 | 0.162    |
	| 5     | 0.522 | 0.539 | 0.509 | 0.197    |
	| 6     | 0.649 | 0.582 | 0.565 | 0.223    |
	| 7     | 0.676 | 0.601 | 0.587 | 0.227    |
	| 8     | 0.67  | 0.573 | 0.595 | 0.233    |
	| 9     | 0.637 | 0.603 | 0.595 | 0.234    |
	| 10    | 0.677 | 0.585 | 0.588 | 0.232    |
	| 11    | 0.698 | 0.598 | 0.618 | 0.244    |
	| 12    | 0.7   | 0.579 | 0.598 | 0.236    |
	| 13    | 0.681 | 0.606 | 0.602 | 0.24     |
	| 14    | 0.712 | 0.58  | 0.609 | 0.243    |
	| 15    | 0.739 | 0.584 | 0.621 | 0.248    |
	| 16    | 0.718 | 0.619 | 0.647 | 0.249    |
	| 17    | 0.711 | 0.634 | 0.629 | 0.249    |
	| 18    | 0.731 | 0.621 | 0.635 | 0.258    |
	| 19    | 0.748 | 0.609 | 0.641 | 0.255    |
	| 20    | 0.744 | 0.615 | 0.631 | 0.259    |
	| 21    | 0.714 | 0.649 | 0.649 | 0.262    |
	| 22    | 0.741 | 0.623 | 0.638 | 0.261    |
	| 23    | 0.746 | 0.636 | 0.639 | 0.259    |
	| 24    | 0.709 | 0.652 | 0.655 | 0.259    |
	| 25    | 0.738 | 0.646 | 0.655 | 0.263    |
	| 26    | 0.736 | 0.669 | 0.67  | 0.27     |
	| 27    | 0.735 | 0.636 | 0.648 | 0.269    |
	| 28    | 0.759 | 0.63  | 0.655 | 0.269    |
	| 29    | 0.736 | 0.634 | 0.655 | 0.261    |
	| 30    | 0.7   | 0.677 | 0.661 | 0.27     |
	| 31    | 0.761 | 0.659 | 0.67  | 0.265    |
	| 32    | 0.775 | 0.654 | 0.682 | 0.276    |
	| 33    | 0.758 | 0.659 | 0.682 | 0.28     |
	| 34    | 0.75  | 0.664 | 0.663 | 0.271    |
	| 35    | 0.764 | 0.659 | 0.664 | 0.274    |
	| 36    | 0.731 | 0.667 | 0.659 | 0.271    |
	| 37    | 0.754 | 0.658 | 0.663 | 0.27     |
	| 38    | 0.758 | 0.66  | 0.677 | 0.273    |
	| 39    | 0.767 | 0.663 | 0.666 | 0.267    |
	| 40    | 0.781 | 0.666 | 0.676 | 0.27     |
	| 41    | 0.754 | 0.655 | 0.658 | 0.27     |
	| 42    | 0.768 | 0.655 | 0.658 | 0.271    |
	| 43    | 0.776 | 0.664 | 0.676 | 0.271    |
	| 44    | 0.772 | 0.652 | 0.669 | 0.275    |
	| 45    | 0.778 | 0.667 | 0.678 | 0.275    |
	| 46    | 0.756 | 0.669 | 0.675 | 0.28     |
	| 47    | 0.768 | 0.683 | 0.69  | 0.281    |
	| 48    | 0.764 | 0.68  | 0.684 | 0.282    |
	| 49    | 0.759 | 0.678 | 0.679 | 0.279    |
	| 50    | 0.763 | 0.681 | 0.683 | 0.282    |
	| 51    | 0.57  | 0.413 | 0.345 | 0.0884   |
	
üìä –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è (–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
	| –≠–ø–æ—Ö–∞ | Precision | Recall | mAP@0.5 | mAP@0.5:0.95 |
	| ----- | --------- | ------ | ------- | ------------ |
	| 32    | 0.775     | 0.654  | 0.682   | 0.276        |
	
	


### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö

```python
from test_model import test_yolo_model

test_yolo_model(
    model_path="results/football_model/weights/best.pt",
    images_folder="test_images",
    output_folder="results/football_model/test_output",
    show_results=True,
    clear_output_folder=True
)
```

- `model_path`: –ø—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ (`best.pt`)  
- `images_folder`: –ø–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ç–µ—Å—Ç–∞  
- `output_folder`: –∫—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã  
- `show_results`: –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Jupyter Notebook  
- `clear_output_folder`: –æ—á–∏—â–∞—Ç—å –ø–∞–ø–∫—É –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º  

---

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –≤–∏–¥–µ–æ

```python
from test_model import test_yolo_video

test_yolo_on_video(
    model_path="results/football_model/weights/best.pt",
    video_path="test_videos/test_video.mp4",
    output_path="results/football_model/video_output.mp4",
    img_size=416
)
```

- `video_path`: –ø—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É –≤–∏–¥–µ–æ  
- `output_path`: –ø—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É –≤–∏–¥–µ–æ —Å –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏  
- `img_size`: —Ä–∞–∑–º–µ—Ä –∫–∞–¥—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 416√ó416)  

üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–º–µ–Ω—å—à–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∫–∞–¥—Ä–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ CPU.

---

## üìä –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ–º—ã–µ –æ–±—ä–µ–∫—Ç—ã

- `Football` ‚Äî –º—è—á  
- `Player` ‚Äî –∏–≥—Ä–æ–∫  
- `Referee` ‚Äî —Å—É–¥—å—è  

---

## ‚öôÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö.  
- –ù–∞ CPU –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ–π (–ø—Ä–∏–º–µ—Ä–Ω–æ 2‚Äì5 FPS –¥–ª—è 1080p).  
- YOLOv5 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥–æ–Ω—è–µ—Ç —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ (auto-resize).  

---

## üîó –°—Å—ã–ª–∫–∏

- [YOLOv5 GitHub](https://github.com/ultralytics/yolov5)  
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenCV](https://opencv.org/)